import{M as De,N as ee,e as de,f,C as Ue,O as Me,g as be,i as K,D as ze,m as c,b as je,o as n,c as v,a,n as h,t as R,j as l,k as i,q as j,F as z,l as L,G as ae,P as Ke,E as G,Q as We,R as Pe,S as qe,T as Ge,U as Le,x as _e,y as ve,_ as ce,V as He,w as Se,W as oe,X as Z,Y as Te,Z as Qe,$ as Ve,a0 as Re,a1 as Fe,a2 as Xe,z as Ye,a3 as Ze,a4 as Ne,a5 as et,a6 as tt,B as lt}from"./index.e4ce814e.js";import{s as J}from"./request.9c690564.js";import{s as Oe}from"./regexpUtil.d17c4edf.js";import{i as re,a as Ie}from"./userUtil.2a89dae5.js";import"./cookieUtil.c9429606.js";const pe=De("selectedmarkWords",{state:()=>({words:[]}),getters:{word(){return this.words.sort((o,A)=>o.id-A.id)}},actions:{add(o){this.words.push(o)},remove(o){this.words.splice(this.words.map(A=>A.id).indexOf(o.id),1)},removeAll(){this.words=[]},exist(o){for(let A of this.words)if(o==A.id)return!0;return!1}}}),P=De("markResult",{state:()=>({case_facts:"",case_name:"",event_type:"",type_ID:0,trigger:[],arguments:[],case_judgement:{}}),getters:{markResult(){return{event_type:this.event_type,type_ID:this.type_ID,trigger:ee(this.trigger),arguments:ee(this.arguments),case_judgement:ee(this.case_judgement)}},getFact(){return this.case_facts},finalResult(){return{case_name:this.case_name,case_facts:this.case_facts,event_type:this.event_type,type_ID:this.type_ID,trigger:ee(this.trigger),arguments:ee(this.arguments),case_judgement:ee(this.case_judgement)}}},actions:{updateEventType(o,A){this.$state.event_type=o,this.$state.type_ID=A},updateTriggers(o){this.$state.trigger=o},updateJudgement(o){this.$state.case_judgement=o},updateArgument(o){this.$state.arguments=o},updateFactAndName(o,A){this.$state.case_facts=o,this.$state.case_name=A}}}),S=De("markList",{state:()=>({ids:[],todoIds:[],recordIds:[],count:0}),getters:{length(){return this.ids.length},current(){return this.ids[this.count%this.length]},currentId(){return this.todoIds[this.count%this.length]},currentRecordId(){return this.recordIds[this.count%this.length]},status(){return`\u5171\u8BA1${this.length}\u6761,\u5F53\u524D\u5904\u7406\u5230${this.count+1}\u6761`}},actions:{updateList(o){this.$state.ids=o,this.$state.count=0},updateTodoIds(o){this.$state.todoIds=o},updateRecordIds(o){this.$state.recordIds=o},next(){this.$state.count=(this.$state.count+1)%this.length},prev(){this.$state.count=(this.$state.count-1+this.length)%this.length},delete(o){let A=this.$state.todoIds;for(let y=0;y<A.length;y++)A[y]==o&&(this.$state.ids=this.$state.ids.filter(C=>C!=this.$state.ids[y]));this.$state.todoIds=this.$state.todoIds.filter(y=>y!=o)}}}),we=o=>(_e("data-v-d78e198e"),o=o(),ve(),o),st={key:0,class:"case_content"},ut={class:"container"},at={class:"title"},nt={class:"basic"},ot=we(()=>a("span",{class:"hint"},"[\u57FA\u672C\u60C5\u51B5]\uFF1A",-1)),it={class:"displayText"},rt=["onClick"],dt={key:1,class:"displayText"},ct={class:Le("")},mt={class:"fixResult"},pt={class:"cpfxgc"},_t=we(()=>a("span",{class:"hint"},"[\u88C1\u5224\u5206\u6790\u8FC7\u7A0B]\uFF1A",-1)),vt={class:"displayText"},ft={class:"result"},gt=we(()=>a("span",{class:"hint"},"[\u5224\u51B3\u7ED3\u679C]\uFF1A",-1)),ht=de({__name:"caseContent",props:{detailId:String},setup(o){const A=o;let y=f({id:"",name:"",analysisProcess:"",paperId:"",paperName:"",result:""});const C=f(!1);f(!1);const x=f(!1),d=m=>{C.value=!0,J.get("/crime/paper/"+m).then(async r=>{let $=[],E=0;if(r.data.baseInfo)for(let p of Oe(r.data.baseInfo))p!=""&&await J.post("/word/cut",{word:p}).then(V=>{$.push(V.data.cutList.map(O=>({id:E++,value:O})))});r.data.processArr=Oe(r.data.analysisProcess),r.data.baseInfoArr=$,r.data.baseInfoArrFortag=r.data.baseInfo.split(""),y.value=r.data,P().updateFactAndName(r.data.baseInfo,r.data.name)}).finally(()=>C.value=!1)},I=m=>{let r=document.getElementsByClassName("displayItem_"+m.id)[0];pe().exist(m.id)?(r.classList.remove("checked"),pe().remove(m)):(r.classList.add("checked"),pe().add(m))},w=()=>{document.querySelectorAll(".checked").forEach(m=>{m.classList.remove("checked"),pe().removeAll()})},q=m=>{Ke.prompt("\u62A5\u8BEF\u539F\u56E0","Tip",{confirmButtonText:"\u63D0\u4EA4",cancelButtonText:"\u53D6\u6D88"}).then(({value:r})=>{let E={todoId:S().currentId,reason:r};J.post("/blockTodo",E).then(p=>{p.data?G.success("\u53CD\u9988\u6210\u529F\uFF0C\u7B49\u5F85\u5904\u7406"):G.warning(p.msg)})})},te=(m,r,$=!1)=>{var O;let E=!1;const p=document.querySelector(".basic .displayText"),V=p==null?void 0:p.getElementsByTagName("span");if(!$)for(let Y=0;Y<m.length;Y++){let M=document.createElement("span"),k=[];for(let H=0;H<V.length;H++){let se=(O=V.item(H))==null?void 0:O.innerText;if(se!="")if(m[Y].value.indexOf(se)==-1){if(E)if(E=!1,M.textContent==m[Y].value){let T=document.createElement("span");T.style.backgroundColor="#fff",T.style.color="#2CB3FF",T.style.padding="3px",T.style.fontSize="12px",T.style.borderRadius="3px",T.style.marginLeft="5px",T.style.marginBottom="2px",T.innerText=m[Y].role,M.appendChild(T);break}else M=document.createElement("span"),k=[];continue}else{E||(M.style.backgroundColor="#00A4FF",M.style.borderRadius="3px",M.style.color="#1B2E48",M.style.padding="5px",M.style.lineHeight="50px",E=!0);let T=document.createElement("span");T.innerText=se,M.appendChild(T),k.push(V.item(H))}}k.length!=0&&(p==null||p.replaceChild(M,k[0]),k.forEach(H=>{H.remove()}))}};return Ue(()=>A.detailId,m=>{d(m)}),S().$subscribe((m,r)=>{d(S().current)},{detached:!1}),P().$subscribe((m,r)=>{}),Me(()=>{x.value&&te(P().arguments,"",!1)}),be(()=>{setTimeout(()=>{d(S().current)},200)}),(m,r)=>{const $=K("el-icon"),E=ze("loading");return c(y)?je((n(),v("div",st,[a("div",ut,[a("div",at,[h(R(c(y).name)+" ",1),l($,{color:"#67C23A",style:{float:"right",cursor:"pointer"},onClick:w},{default:i(()=>[l(c(We))]),_:1}),l($,{color:"red",style:{float:"right",cursor:"pointer",right:"10px"},onClick:r[0]||(r[0]=p=>q(c(y)))},{default:i(()=>[l(c(Pe))]),_:1}),x.value?(n(),j($,{key:1,color:"#007ACC",style:{float:"right",cursor:"pointer",right:"20px"},onClick:r[2]||(r[2]=p=>x.value=!x.value)},{default:i(()=>[l(c(Ge))]),_:1})):(n(),j($,{key:0,color:"#007ACC",style:{float:"right",cursor:"pointer",right:"20px"},onClick:r[1]||(r[1]=p=>x.value=!x.value)},{default:i(()=>[l(c(qe))]),_:1}))]),a("div",nt,[ot,x.value?(n(),v("div",dt,[(n(!0),v(z,null,L(c(y).baseInfoArrFortag,p=>(n(),v("span",ct,R(p),1))),256))])):(n(!0),v(z,{key:0},L(c(y).baseInfoArr,p=>(n(),v("div",it,[(n(!0),v(z,null,L(p,V=>(n(),v("span",{class:Le("displayItem_"+V.id),onClick:O=>I(V)},R(V.value),11,rt))),256))]))),256))]),a("div",mt,[a("div",pt,[_t,a("div",null,[(n(!0),v(z,null,L(c(y).processArr,p=>(n(),v("div",vt,R(p),1))),256))])]),a("div",ft,[gt,h(R(c(y).result),1)])])])])),[[E,C.value]]):ae("",!0)}}});const kt=ce(ht,[["__scopeId","data-v-d78e198e"]]),fe=o=>(_e("data-v-74e2c73a"),o=o(),ve(),o),yt={class:"container"},Ct=fe(()=>a("div",{class:"lable"},"\u64CD\u4F5C\u5DE5\u4F5C\u53F0",-1)),Et={class:"content"},Ft={class:"crimeName"},At=fe(()=>a("div",null,"\u7F6A\u540D\u6807\u7B7E\uFF1A",-1)),$t={class:"crimeSelector"},Bt={class:"trigger"},xt=fe(()=>a("div",null,"\u89E6\u53D1\u8BCD\u6807\u6CE8\uFF1A",-1)),Vt={class:"add"},It={class:"choose"},Dt={class:"argment"},bt=fe(()=>a("div",null,"\u8BBA\u5143\u6807\u6CE8\uFF1A",-1)),wt={class:"argmentItem"},St=["onContextmenu","onClick"],Tt={class:"add"},Rt={class:"choose"},Nt={class:"judgement"},Ot=fe(()=>a("div",null,"\u5BA1\u5224\u7ED3\u679C\uFF1A",-1)),Ut={class:"judge_item"},zt={class:"judge_item"},jt={class:"judge_item"},Kt={class:"judge_item"},Lt={class:"judge_item"},Jt={class:"judge_item"},Mt={class:"judge_item"},Wt={class:"submit"},Pt=de({__name:"chooseBox",props:["isValid"],emits:["previewResult","submitRecord"],setup(o,{emit:A}){const y=o,C=f(),x=f(),d=f(!1),I=f(""),w=f(0),q=f(!1),te=f(!1),m=f(""),r=f([]),$=f({id:0,name:"",trigger:"",argument:""});let E=3;const p=f([]),V=f(new Set([])),O=f([]),Y=f(new Set([])),M=f(new Set([])),k=f({case_statutes:"",punish_of_money:"",accusation:"",is_death_penalty:!1,is_life_imprisonment:!1,term_of_imprisonment:"",probation:""});f(!1);const H=e=>{$.value=e,k.value.accusation=e.name,I.value=e.name,w.value=e.id;let t=1;V.value=new Set(e.trigger.split(",").map(_=>({id:t++,name:_}))),Y.value=new Set(e.argument.split(",").map(_=>({id:t++,role:_,value:"",start:0,end:0}))),M.value=new Set(e.argument.split(",").map(_=>_)),u()},se=e=>{e==0?(te.value=!0,Te(()=>{x.value.input.focus()})):(q.value=!0,Te(()=>{C.value.input.focus()}))},T=e=>{if(e==0)m.value&&p.value.push({id:E++,name:m.value}),te.value=!1,m.value="";else{if(m.value){let t=m.value.split(":");O.value.push({id:3,role:t[0],value:t[1],start:Q(t[1]),end:Q(t[1])+t[1].length})}q.value=!1,m.value=""}},Q=e=>P().finalResult.case_facts.indexOf(e),$e=e=>{p.value.splice(p.value.map(t=>t.name).indexOf(e.name),1)},Be=e=>(O.value.splice(O.value.map(t=>t.id).indexOf(e.id),1),!1),xe=e=>{Ke.prompt("\u4FEE\u6539\u5185\u5BB9","Tip",{confirmButtonText:"\u63D0\u4EA4",cancelButtonText:"\u53D6\u6D88",inputValue:e.value}).then(({value:t})=>{e.value=t,e.start=Q(t),e.end=Q(t)+t.length-1})},ge=(e,t)=>{let _="";const F=ee(pe().word);if(F.length!=0){for(let s of F)_+=s.value;e==0?p.value.push({id:++E,name:_}):O.value.push({id:++E,role:t==null?void 0:t.role,value:_,start:Q(_),end:Q(_)+_.length-1})}},g=()=>{let e=P().getFact;if(V.value.size==0){G.warning("\u8FD8\u6CA1\u6709\u9009\u62E9\u5BF9\u5E94\u7684schema");return}let t=0,_=V.value;p.value=[];for(let F of _)console.log(e.indexOf(F.name)),e.indexOf(F.name)!=-1&&(p.value.push({id:E++,name:F.name}),t++);G.success(`\u626B\u63CF\u7ED3\u675F\uFF0C\u5171\u627E\u5230${t}\u4E2A`)},u=()=>{P().updateArgument(O.value),P().updateEventType(I.value,w.value),P().updateJudgement(k.value),P().updateTriggers(p.value)},B=()=>{O.value=[],p.value=[],k.value={case_statutes:"",punish_of_money:"",is_death_penalty:!1,is_life_imprisonment:!1,term_of_imprisonment:"",probation:"",accusation:k.value.accusation}},U=()=>{J.get("/schema").then(e=>{r.value=e.data})},D=()=>{H($.value)},le=()=>{A("submitRecord"),y.isValid&&me()};P().$subscribe(()=>{}),S().$subscribe((e,t)=>{y.isValid&&me()},{detached:!1});const he=e=>{e?S().next():S().prev(),B()},me=()=>{let e=S().currentRecordId;J.get("/record/"+e).then(t=>{let _=t.data;O.value=JSON.parse(_.arguments.toString()),p.value=JSON.parse(_.triggers.toString()),k.value=JSON.parse(_.caseJudgement.toString()),I.value=_.eventType,w.value=_.typeID,D(),u()})},X=()=>{if($.value.id==0){G.warning("\u8FD8\u6CA1\u6709\u9009\u62E9\u5BF9\u5E94\u7684schema");return}let e=$.value.id,t=S().current;d.value=!0,J.get("/chatgpt/ask/"+t+"/"+e).then(_=>{let F=_.answer;F=F.replaceAll("\uFF1B",`
`).replaceAll(`

`,`
`).replaceAll(" ","").replaceAll("\u8BBA\u5143",""),F.split(`
`).filter(b=>b.indexOf("\uFF1A")!=-1).forEach(b=>{let N=b.split("\uFF1A"),W=N[1];if(M.value.forEach(Ce=>{N[0].indexOf(Ce.toString())!=-1&&(N[0]=Ce.toString())}),W!="\u65E0")if(W.indexOf("\u3001")==-1)O.value.push({id:++E,role:N[0],value:W,start:Q(W),end:Q(W)+W.length-1});else{let Ce=W.split("\u3001");for(let Ee of Ce)O.value.push({id:++E,role:N[0],value:Ee,start:Q(Ee),end:Q(Ee)+Ee.length-1})}})}).finally(()=>d.value=!1)},ke=()=>{let e=ye(k.value.case_statutes);k.value.case_statutes=e},ne=e=>{let t=k.value.term_of_imprisonment;e&&(t=k.value.probation);let _=0;if(t.indexOf(".")!=-1){let F=t.split(".");_=parseInt(F[0])*12+parseInt(F[1])}else _=parseInt(t)*12;e?k.value.probation=""+_:k.value.term_of_imprisonment=""+_},ie=()=>{const e=k.value.punish_of_money.replaceAll("\u5143",""),t=ue(e);k.value.punish_of_money=""+t};function ue(e){const t={\u96F6:0,\u4E00:1,\u58F9:1,\u4E8C:2,\u8D30:2,\u4E24:2,\u4E09:3,\u53C1:3,\u56DB:4,\u8086:4,\u4E94:5,\u4F0D:5,\u516D:6,\u9646:6,\u4E03:7,\u67D2:7,\u516B:8,\u634C:8,\u4E5D:9,\u7396:9,\u5341:10,\u62FE:10,\u767E:100,\u4F70:100,\u5343:1e3,\u4EDF:1e3,\u4E07:1e4,\u5341\u4E07:1e5,\u767E\u4E07:1e6,\u5343\u4E07:1e7,\u4EBF:1e8};let _=e.length;if(_==0)return-1;if(_==1)return t[e]<=10?t[e]:-1;let F=0;if(t[e[0]]==10&&(e="\u4E00"+e,_++),_>=3&&t[e[_-1]]<10){const N=t[e[_-2]];if(N==100||N==1e3||N==1e4||N==1e8){for(const W in t)if(t[W]==N/10){e+=W,_+=W.length;break}}}if(e.match(/亿/g)&&e.match(/亿/g).length>1)return-1;let s;if(s=e.split("\u4EBF"),s.length==2){const N=s[1]==""?0:ue(s[1]);return F+ue(s[0])*1e8+N}if(s=e.split("\u4E07"),s.length==2){const N=s[1]==""?0:ue(s[1]);return F+ue(s[0])*1e4+N}let b=0;for(;b<_;){const N=t[e[b]],W=t[e[b+1]];W>9&&(F+=N*W),b++,b==_&&(F+=N<=9?N:0)}return F}function ye(e){const t=new Map([["\u96F6",0],["\u4E00",1],["\u4E8C",2],["\u4E09",3],["\u56DB",4],["\u4E94",5],["\u516D",6],["\u4E03",7],["\u516B",8],["\u4E5D",9]]);let _=!1,F="";for(let s=0;s<e.length;s++){const b=e.charAt(s);t.has(b)?F+=t.get(b):b==="\uFF0C"||b==="\u3001"||b==="\u548C"?(F+=",",_=!1):b==="\u6761"?_=!0:b==="\u7B2C"?_&&(F+="."):b==="\u5341"?t.has(e.charAt(s-1))?t.has(e.charAt(s+1))||(F+="0"):F+="1":b==="\u767E"&&(t.has(e.charAt(s+1))||(F+="00"))}return F}return be(()=>{u(),U(),y.isValid&&me()}),(e,t)=>{const _=K("el-icon"),F=K("el-switch");return n(),v("div",yt,[Ct,a("div",Et,[a("div",Ft,[At,a("div",$t,[l(c(He),{modelValue:I.value,"onUpdate:modelValue":t[0]||(t[0]=s=>I.value=s),class:"crimeSelector0",placeholder:"\u7F6A\u540D",filterable:"",onChange:H},{default:i(()=>[(n(!0),v(z,null,L(r.value,s=>(n(),j(c(Qe),{key:s.id,label:s.name,value:s},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),a("div",Bt,[xt,(n(!0),v(z,null,L(p.value,s=>(n(),j(c(Ve),{key:s.id,class:"triggerItems",closable:"",onClose:b=>$e(s),type:"danger"},{default:i(()=>[h(R(s.name),1)]),_:2},1032,["onClose"]))),128)),(n(!0),v(z,null,L(V.value,s=>(n(),j(c(Ve),{key:s.id,class:"triggerItems",type:"info"},{default:i(()=>[h(R(s.name),1)]),_:2},1024))),128)),a("div",Vt,[te.value?(n(),j(c(oe),{key:0,ref_key:"triggerInputRef",ref:x,modelValue:m.value,"onUpdate:modelValue":t[1]||(t[1]=s=>m.value=s),size:"small","disable-transitions":!1,onKeyup:t[2]||(t[2]=Se(s=>T(0),["enter"])),onBlur:t[3]||(t[3]=s=>T(0))},null,8,["modelValue"])):(n(),j(c(Z),{key:1,type:"info",size:"small",icon:c(Re),circle:"",onClick:t[4]||(t[4]=s=>se(0))},null,8,["icon"]))]),a("div",It,[l(c(Z),{type:"success",size:"small",round:"",onClick:t[5]||(t[5]=s=>ge(0))},{default:i(()=>[h("\u9009\u62E9\u89E6\u53D1\u8BCD")]),_:1}),l(c(Z),{type:"primary",size:"small",round:"",onClick:g},{default:i(()=>[h("\u626B\u63CF\u4E00\u4E0B")]),_:1})])]),a("div",Dt,[bt,a("div",wt,[(n(!0),v(z,null,L(O.value,s=>(n(),v("span",{class:"argmentItems",onContextmenu:b=>Be(s),onClick:b=>xe(s)},R(s.role+":"+s.value),41,St))),256)),(n(!0),v(z,null,L(Y.value,s=>(n(),j(c(Ve),{key:s.id,class:"triggerItems",type:"info",onClick:b=>ge(1,s)},{default:i(()=>[h(R(s.role),1)]),_:2},1032,["onClick"]))),128))]),a("div",Tt,[q.value?(n(),j(c(oe),{key:0,ref_key:"argmentInputRef",ref:C,modelValue:m.value,"onUpdate:modelValue":t[6]||(t[6]=s=>m.value=s),size:"small","disable-transitions":!1,onKeyup:t[7]||(t[7]=Se(s=>T(1),["enter"])),onBlur:t[8]||(t[8]=s=>T(1))},null,8,["modelValue"])):(n(),j(c(Z),{key:1,type:"info",size:"small",icon:c(Re),circle:"",onClick:t[9]||(t[9]=s=>se(1))},null,8,["icon"]))]),a("div",Rt,[l(c(Z),{color:"#626aef",size:"small",disabled:d.value,round:"",onClick:t[10]||(t[10]=s=>X())},{default:i(()=>[h(R(d.value?"\u6B63\u5728\u5904\u7406...":"AI\u667A\u80FD\u6807\u6CE8"),1)]),_:1},8,["disabled"])])]),a("div",Nt,[Ot,a("div",Ut,[h(" \u6CD5\u6761\uFF1A"),l(c(oe),{modelValue:k.value.case_statutes,"onUpdate:modelValue":t[11]||(t[11]=s=>k.value.case_statutes=s),size:"small",class:"judge_item_input"},null,8,["modelValue"]),l(_,{style:{"margin-left":"5px",cursor:"pointer"},size:"16px",onClick:ke},{default:i(()=>[l(c(Fe),{color:"#589"})]),_:1})]),a("div",zt,[h(" \u6B7B\u5211\uFF1A"),l(F,{modelValue:k.value.is_death_penalty,"onUpdate:modelValue":t[12]||(t[12]=s=>k.value.is_death_penalty=s)},null,8,["modelValue"])]),a("div",jt,[h(" \u65E0\u671F\uFF1A"),l(F,{modelValue:k.value.is_life_imprisonment,"onUpdate:modelValue":t[13]||(t[13]=s=>k.value.is_life_imprisonment=s)},null,8,["modelValue"])]),a("div",Kt,[h(" \u7F13\u5211\uFF1A"),l(c(oe),{modelValue:k.value.probation,"onUpdate:modelValue":t[14]||(t[14]=s=>k.value.probation=s),size:"small",placeholder:"\u5355\u4F4D\uFF08\u6708\uFF09",class:"judge_item_input"},null,8,["modelValue"]),l(_,{style:{"margin-left":"5px",cursor:"pointer"},size:"16px",onClick:t[15]||(t[15]=s=>ne(!0))},{default:i(()=>[l(c(Fe),{color:"#6a1"})]),_:1})]),a("div",Lt,[h(" \u76D1\u7981\uFF1A"),l(c(oe),{modelValue:k.value.term_of_imprisonment,"onUpdate:modelValue":t[16]||(t[16]=s=>k.value.term_of_imprisonment=s),size:"small",placeholder:"\u5355\u4F4D\uFF08\u6708\uFF09",class:"judge_item_input"},null,8,["modelValue"]),l(_,{style:{"margin-left":"5px",cursor:"pointer"},size:"16px",onClick:t[17]||(t[17]=s=>ne(!1))},{default:i(()=>[l(c(Fe),{color:"#194"})]),_:1})]),a("div",Jt,[h(" \u7F5A\u6B3E\uFF1A"),l(c(oe),{modelValue:k.value.punish_of_money,"onUpdate:modelValue":t[18]||(t[18]=s=>k.value.punish_of_money=s),size:"small",placeholder:"\u5355\u4F4D\uFF08\u5143\uFF09",class:"judge_item_input"},null,8,["modelValue"]),l(_,{style:{"margin-left":"5px",cursor:"pointer"},size:"16px",onClick:ie},{default:i(()=>[l(c(Fe),{color:"#944"})]),_:1})]),a("div",Mt,[h(" \u7F6A\u540D\uFF1A"),l(c(oe),{modelValue:k.value.accusation,"onUpdate:modelValue":t[19]||(t[19]=s=>k.value.accusation=s),size:"small",disabled:!0,class:"judge_item_input"},null,8,["modelValue"])])])]),a("div",Wt,[l(c(Z),{plain:"",onClick:t[20]||(t[20]=s=>he(!1))},{default:i(()=>[h("\u4E0A\u4E00\u4E2A")]),_:1}),l(c(Z),{type:"danger",disable:!0,plain:"",onClick:B},{default:i(()=>[h("\u6E05\u7A7A\u7ED3\u679C")]),_:1}),l(c(Z),{type:"primary",plain:"",onClick:u},{default:i(()=>[h("\u9884\u89C8\u7ED3\u679C")]),_:1}),l(c(Z),{type:"success",plain:"",onClick:le},{default:i(()=>[h("\u63D0\u4EA4")]),_:1}),l(c(Z),{plain:"",onClick:t[21]||(t[21]=s=>he(!0))},{default:i(()=>[h("\u4E0B\u4E00\u4E2A")]),_:1})])])}}});const qt=ce(Pt,[["__scopeId","data-v-74e2c73a"]]),Gt=o=>(_e("data-v-61913119"),o=o(),ve(),o),Ht={class:"chooseContainer"},Qt=Gt(()=>a("div",{class:"lable"},"\u6807\u6CE8\u7ED3\u679C\u9884\u89C8\uFF1A",-1)),Xt={class:"chooseResult"},Yt={key:0},Zt={key:1},el=de({__name:"chooseResult",props:["isValid"],emits:["expand"],setup(o,{emit:A}){const y=f(ee(P().markResult)),C=f(JSON.stringify(y,null,"	")),x=f(!1);P().$subscribe((I,w)=>{C.value=JSON.stringify(ee(P().markResult),null,"	")},{detached:!1});const d=I=>{x.value=I,A("expand",I);let w=document.querySelectorAll(".chooseContainer")[0];I?w.style.height="400%":w.style.height="100%"};return(I,w)=>(n(),v("div",Ht,[Qt,a("div",Xt,[x.value?(n(),v("pre",Zt,R(C.value)+`
      `,1)):(n(),v("p",Yt,R(C.value),1))]),x.value?(n(),v("p",{key:1,class:"expand",onClick:w[1]||(w[1]=q=>d(!1))},"\u6536\u8D77")):(n(),v("p",{key:0,class:"expand",onClick:w[0]||(w[0]=q=>d(!0))},"\u5C55\u5F00"))]))}});const tl=ce(el,[["__scopeId","data-v-61913119"]]),Je=o=>(_e("data-v-6dd02042"),o=o(),ve(),o),ll={class:"container"},sl={key:0,class:"item"},ul={class:"item"},al={class:"item"},nl={class:"item status"},ol=Je(()=>a("span",{class:"dot"},null,-1)),il=Je(()=>a("span",{class:"dot"},null,-1)),rl=de({__name:"statusBar",props:["online","task"],emits:["offline"],setup(o,{emit:A}){const y=o,C=f(y.online),x=f(S().status),d=()=>{C.value&&(C.value=!C.value,A("offline"),G.info("\u5DF2\u4E0B\u673A"))};return S().$subscribe((I,w)=>{x.value=ee(S().status)},{detached:!1}),Ue(()=>y.online,I=>{C.value=I}),(I,w)=>(n(),v("div",ll,[o.task!=""?(n(),v("div",sl,[a("div",ul,"\u5F53\u524D\u4EFB\u52A1\uFF1A"+R(o.task),1),a("div",al,R(x.value),1)])):ae("",!0),a("div",nl,[h(" \u5F53\u524D\u72B6\u6001:"),o.online?(n(),v("span",{key:1,class:"green",onClick:d},[il,h("\u5DE5\u4F5C\u4E2D")])):(n(),v("span",{key:0,class:"grey",onClick:d},[ol,h("\u79BB\u7EBF")]))])]))}});const dl=ce(rl,[["__scopeId","data-v-6dd02042"]]),Ae=o=>(_e("data-v-318f9468"),o=o(),ve(),o),cl={class:"listPanel"},ml={class:"workList"},pl={class:"title"},_l=Ae(()=>a("div",null,"\u4EFB\u52A1\u5217\u8868\uFF1A",-1)),vl={key:0,class:"adminView"},fl={class:"workItems"},gl=["onClick"],hl={class:"workDetail"},kl={class:"title"},yl={class:"remark"},Cl={class:"groups"},El=Ae(()=>a("p",null,"\u53C2\u4E0E\u4EBA\u5458\uFF1A",-1)),Fl={class:"group"},Al={class:"member"},$l={key:0},Bl={key:1},xl=Ae(()=>a("p",{class:"progress"},null,-1)),Vl={key:1,class:"allocation"},Il=Ae(()=>a("p",null,"\u4EFB\u52A1\u5206\u914D",-1)),Dl={class:"submit"},bl={class:"display"},wl={class:"dialog-footer"},Sl={class:"dialog-footer"},Tl=de({__name:"workListPanel",emits:["startWork"],setup(o,{emit:A}){f(!1);const y=f(!0),C=f({id:0,name:"",remark:"",markman:"",validman:"",members:[]}),x=f([]),d=f({id:0,name:"",remark:"",markman:"",validman:"",members:[]}),I=f([]),w=f(0),q=f(""),te=()=>{I.value=[],w.value=0},m=g=>{let u=g,B=0;for(let U of u){let D=parseInt(U.replace(/[^0-9]/ig,""));B+=D}w.value=B};f(""),f({username:"",nickname:""});const r=f([]),$=f([]),E=f(!1),p=f(!1),V=(g,u,B=!1)=>{if(!d.value.isAllocate){alert("\u4EFB\u52A1\u8FD8\u672A\u5206\u914D");return}setTimeout(()=>{A("startWork",g,u,B)},200),G.success("\u6B63\u5728\u83B7\u53D6\u5217\u8868...")},O=(g,u)=>{if(!d.value.isAllocate){alert("\u4EFB\u52A1\u8FD8\u672A\u5206\u914D");return}setTimeout(()=>{A("startWork",g,u+"\u3010\u6807\u6CE8\u7F16\u8F91\u3011",!0)},200)},Y=()=>{J.get("/task").then(g=>{let u=g.data;u.reverse(),re()&&y.value?x.value=u:x.value=u.filter(B=>B.markman.indexOf(Ie())!=-1||B.validman.indexOf(Ie())!=-1)})},M=()=>{E.value=!1,J.post("/task",C.value).then(g=>{x.value.push(C.value),C.value={id:0,name:"",remark:"",members:[],status:0,markman:"",validman:""},G.success("\u65B0\u589E\u6210\u529F")})},k=g=>{d.value=g,console.log(g);let u=g;d.value.members=[];let B=u.markman.split(":");d.value.members.push({groupKey:"\u6807\u6CE8",users:[{nickname:B[0],username:B[1]}]}),B=u.validman.split(":"),d.value.members.push({groupKey:"\u9A8C\u8BC1",users:[{nickname:B[0],username:B[1]}]}),J.get("/task/isAllocate/"+g.id).then(U=>{d.value.isAllocate=U.data})},H=g=>{console.log(g);const u=Ie();console.log(u);for(let B of g)if(B.username==u)return!0;return!1},se=g=>g.groupKey=="\u6807\u6CE8",T=g=>g.groupKey=="\u6807\u6CE8"?d.value.status==0:g.groupKey=="\u9A8C\u8BC1"?d.value.status==1:!1,Q=()=>{let g=d.value.id;J.get("/task/control/"+g).then(u=>{if(u.data){let B=d.value.status;d.value.status=1-B,G.success("\u63A7\u5236\u6743\u4EA4\u6362\u6210\u529F")}})},$e=()=>{re()&&J.get("/user/list").then(g=>{let u=g;r.value=u})},Be=()=>{let g=[];for(let u of d.value.members){let B="";for(let D of u.users)B+=","+D.nickname+":"+D.username;let U=u.groupKey+B;g.push({tid:d.value.id,users:U})}console.log(g),J.post("/task/member",g).then(u=>{console.log(u.data)}),p.value=!1},xe=()=>{let g=[],u={};for(let D of d.value.members)D.groupKey!="\u9A8C\u8BC1"&&(g.push(D.groupKey),u[D.groupKey]=D.users.map(le=>le.username));let B=I.value,U={tid:d.value.id,groupKey:g,uid:u,crimeList:B.map(D=>D.substring(0,D.indexOf("(")))};console.log(U),J.post("/task/todo",U).then(D=>{D.data&&G.success("\u5206\u914D\u6210\u529F")})},ge=()=>{J.get("/crime/list").then(g=>{$.value=g.data})};return be(()=>{$e(),Y(),ge()}),(g,u)=>{const B=K("el-switch"),U=K("el-icon"),D=K("el-button"),le=K("el-input"),he=K("el-checkbox"),me=K("el-checkbox-group"),X=K("el-form-item"),ke=K("el-divider"),ne=K("el-option"),ie=K("el-select"),ue=K("el-form"),ye=K("el-dialog");return n(),v(z,null,[a("div",cl,[a("div",ml,[a("div",pl,[_l,c(re)()?(n(),v("div",vl,[l(B,{modelValue:y.value,"onUpdate:modelValue":u[0]||(u[0]=e=>y.value=e),"inline-prompt":"","active-text":"\u7BA1\u7406\u5458\u89C6\u89D2","inactive-text":"\u7528\u6237\u89C6\u89D2",onChange:Y},null,8,["modelValue"])])):ae("",!0)]),a("div",fl,[(n(!0),v(z,null,L(x.value,e=>(n(),v("div",{class:"workItem",onClick:t=>k(e)},[l(U,{color:"green"},{default:i(()=>[l(c(Xe))]),_:1}),a("span",null,R(e.name),1),a("span",null,[l(U,null,{default:i(()=>[l(c(Ye))]),_:1})])],8,gl))),256)),c(re)()?(n(),v("div",{key:0,class:"addItem",onClick:u[1]||(u[1]=e=>E.value=!0)},"+")):ae("",!0)])]),a("div",hl,[a("div",kl,R(d.value.name),1),a("div",yl,R(d.value.remark),1),a("div",Cl,[El,(n(!0),v(z,null,L(d.value.members,e=>(n(),v("div",null,[a("div",Fl,[h(R(e.groupKey)+"\uFF1A",1),(n(!0),v(z,null,L(e.users,t=>(n(),v("span",Al,R(t.nickname),1))),256)),H(e.users)&&T(e)?(n(),v("span",$l,[l(U,{style:{float:"right",cursor:"pointer"},color:"blue",size:"20px",onClick:Q},{default:i(()=>[l(c(Ze))]),_:1}),se(e)?(n(),j(U,{key:0,style:{float:"right",right:"10px",cursor:"pointer"},color:"#E44F26",size:"20px",onClick:u[2]||(u[2]=t=>O(d.value.id,d.value.name))},{default:i(()=>[l(c(Ne))]),_:1})):ae("",!0),l(U,{style:{float:"right",right:"20px",cursor:"pointer"},color:"green",size:"20px",onClick:t=>V(d.value.id,d.value.name,e.groupKey=="\u9A8C\u8BC1")},{default:i(()=>[l(c(et))]),_:2},1032,["onClick"])])):H(e.users)&&!T(e)?(n(),v("span",Bl,[l(U,{style:{float:"right",right:"10px",cursor:"not-allowed"},color:"orange",size:"20px"},{default:i(()=>[l(c(tt))]),_:1})])):ae("",!0)]),xl]))),256))]),d.value.id>0&&c(re)()?(n(),v("div",{key:0,class:"edit",onClick:u[3]||(u[3]=e=>p.value=!0)},[h("\u7F16\u8F91"),l(U,null,{default:i(()=>[l(c(Ne))]),_:1})])):ae("",!0),c(re)()?(n(),v("div",Vl,[Il,a("div",Dl,[l(D,{type:"warning",round:"",onClick:te},{default:i(()=>[h("\u6E05\u7A7A\u9009\u4E2D")]),_:1}),l(D,{type:"success",round:"",onClick:xe},{default:i(()=>[h("\u63D0\u4EA4")]),_:1})]),a("div",bl,[h("\u603B\u9009\u62E9\u6761\u6570\uFF1A"+R(w.value),1),l(le,{size:"small",placeholder:"\u8FC7\u6EE4","prefix-icon":c(lt),modelValue:q.value,"onUpdate:modelValue":u[4]||(u[4]=e=>q.value=e)},null,8,["prefix-icon","modelValue"])]),l(me,{modelValue:I.value,"onUpdate:modelValue":u[5]||(u[5]=e=>I.value=e),onChange:m},{default:i(()=>[(n(!0),v(z,null,L($.value.filter(e=>e.indexOf(q.value)!=-1),e=>(n(),j(he,{label:e},null,8,["label"]))),256))]),_:1},8,["modelValue"])])):ae("",!0)])]),a("div",null,[l(ye,{modelValue:E.value,"onUpdate:modelValue":u[11]||(u[11]=e=>E.value=e),title:"\u65B0\u589E\u4EFB\u52A1"},{footer:i(()=>[a("span",wl,[l(D,{onClick:u[10]||(u[10]=e=>E.value=!1)},{default:i(()=>[h("\u53D6\u6D88")]),_:1}),l(D,{type:"primary",onClick:M},{default:i(()=>[h(" \u786E\u8BA4 ")]),_:1})])]),default:i(()=>[l(ue,{model:C.value},{default:i(()=>[l(X,{label:"\u540D\u79F0"},{default:i(()=>[l(le,{modelValue:C.value.name,"onUpdate:modelValue":u[6]||(u[6]=e=>C.value.name=e),autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(X,{label:"\u5907\u6CE8"},{default:i(()=>[l(le,{modelValue:C.value.remark,"onUpdate:modelValue":u[7]||(u[7]=e=>C.value.remark=e),autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(ke,{"content-position":"left"},{default:i(()=>[h("\u53C2\u4E0E\u4EBA\u5458")]),_:1}),l(X,{label:"\u4EBA\u5458\u6DFB\u52A0\u6CE8\u610F\u4E8B\u9879"},{default:i(()=>[h(" \u4EBA\u5458\u5206\u4E3A\u6807\u6CE8\u3001\u9A8C\u8BC1 ")]),_:1}),l(X,{label:"\u6807\u6CE8"},{default:i(()=>[l(ie,{modelValue:C.value.markman,"onUpdate:modelValue":u[8]||(u[8]=e=>C.value.markman=e),placeholder:"\u9009\u62E9\u7528\u6237"},{default:i(()=>[(n(!0),v(z,null,L(r.value,e=>(n(),j(ne,{label:e.nickname,value:e.nickname+":"+e.username},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1}),l(X,{label:"\u9A8C\u8BC1"},{default:i(()=>[l(ie,{modelValue:C.value.validman,"onUpdate:modelValue":u[9]||(u[9]=e=>C.value.validman=e),placeholder:"\u9009\u62E9\u7528\u6237"},{default:i(()=>[(n(!0),v(z,null,L(r.value,e=>(n(),j(ne,{label:e.nickname,value:e.nickname+":"+e.username},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),a("div",null,[l(ye,{modelValue:p.value,"onUpdate:modelValue":u[17]||(u[17]=e=>p.value=e),title:"\u7F16\u8F91"},{footer:i(()=>[a("span",Sl,[l(D,{onClick:u[16]||(u[16]=e=>p.value=!1)},{default:i(()=>[h("\u53D6\u6D88")]),_:1}),l(D,{type:"primary",onClick:Be},{default:i(()=>[h(" \u786E\u8BA4 ")]),_:1})])]),default:i(()=>[l(ue,{model:d.value},{default:i(()=>[l(X,{label:"\u540D\u79F0"},{default:i(()=>[l(le,{modelValue:d.value.name,"onUpdate:modelValue":u[12]||(u[12]=e=>d.value.name=e),autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(X,{label:"\u5907\u6CE8"},{default:i(()=>[l(le,{modelValue:d.value.remark,"onUpdate:modelValue":u[13]||(u[13]=e=>d.value.remark=e),autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(ke,{"content-position":"left"},{default:i(()=>[h("\u53C2\u4E0E\u4EBA\u5458")]),_:1}),l(X,{label:"\u4EBA\u5458\u6DFB\u52A0\u6CE8\u610F\u4E8B\u9879"},{default:i(()=>[h(" \u4EBA\u5458\u5206\u4E3A\u6807\u6CE8\u3001\u9A8C\u8BC1 ")]),_:1}),l(X,{label:"\u6807\u6CE8"},{default:i(()=>[l(ie,{modelValue:d.value.markman,"onUpdate:modelValue":u[14]||(u[14]=e=>d.value.markman=e),placeholder:"\u9009\u62E9\u7528\u6237"},{default:i(()=>[(n(!0),v(z,null,L(r.value,e=>(n(),j(ne,{label:e.nickname,value:e.nickname+":"+e.username},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1}),l(X,{label:"\u9A8C\u8BC1"},{default:i(()=>[l(ie,{modelValue:d.value.validman,"onUpdate:modelValue":u[15]||(u[15]=e=>d.value.validman=e),placeholder:"\u9009\u62E9\u7528\u6237"},{default:i(()=>[(n(!0),v(z,null,L(r.value,e=>(n(),j(ne,{label:e.nickname,value:e.nickname+":"+e.username},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])],64)}}});const Rl=ce(Tl,[["__scopeId","data-v-318f9468"]]),Nl={class:"workspace"},Ol={class:"common-layout"},Ul={class:"statusBar"},zl={class:"main"},jl={class:"display"},Kl={class:"result"},Ll={class:"aside"},Jl=de({__name:"markWorkspace",setup(o){const A=f(!1),y=f(""),C=f(0),x=f(!1),d=f(!1),I=m=>{let r=document.querySelectorAll(".main .display")[0],$=document.querySelectorAll(".main .result")[0];console.log(m),m?(r.style.height="20%",$.style.height="80%"):(r.style.height="80%",$.style.height="20%")},w=(m,r,$=!1)=>{$?J.get("/task/check/"+m).then(E=>{if(E.msg=="\u6570\u636E\u4E3A\u7A7A"){G.warning("\u6682\u65E0\u5DF2\u6807\u6CE8\u7ED3\u679C");return}let p=E.data;S().updateList(p.map(V=>V.paperId)),S().updateTodoIds(p.map(V=>V.id)),S().updateRecordIds(p.map(V=>V.recordId)),y.value=r+"\u3010\u68C0\u9A8C\u6A21\u5F0F\u3011",A.value=!0,d.value=!0}):(J.get("/task/todo/"+m).then(E=>{let p=E.data;S().updateList(p.map(V=>V.paperId)),S().updateTodoIds(p.map(V=>V.id))}),y.value=r,A.value=!0,d.value=!1),C.value=m},q=()=>{x.value=!0;let m=P().finalResult,r={};r.triggers=JSON.stringify(m.trigger),r.arguments=JSON.stringify(m.arguments),r.caseJudgement=JSON.stringify(m.case_judgement),r.caseName=m.case_name,r.caseFacts=m.case_facts,r.eventType=m.event_type,r.typeId=m.type_ID,r.todoId=S().currentId,r.tid=C.value,r.id=S().currentRecordId,console.log(r),J.post("/record",r).then($=>{$.data?(G.success("\u63D0\u4EA4\u6210\u529F"),S().delete(S().currentId)):G.warning($.data)}).finally(()=>{x.value=!1})},te=()=>{A.value=!1,y.value=""};return(m,r)=>{const $=K("el-col"),E=K("el-row"),p=ze("loading");return je((n(),v("div",Nl,[a("div",Ol,[a("div",Ul,[l(dl,{online:A.value,task:y.value,onOffline:te},null,8,["online","task"])]),A.value?(n(),j(E,{key:1},{default:i(()=>[l($,{span:18},{default:i(()=>[a("div",zl,[a("div",jl,[l(kt)]),a("div",Kl,[l(tl,{onExpand:I,isValid:d.value},null,8,["isValid"])])])]),_:1}),l($,{span:6},{default:i(()=>[a("div",Ll,[l(qt,{onSubmitRecord:q,isValid:d.value},null,8,["isValid"])])]),_:1})]),_:1})):(n(),j(Rl,{key:0,class:"main",onStartWork:w}))])])),[[p,x.value]])}}});const Hl=ce(Jl,[["__scopeId","data-v-47f1f3e2"]]);export{Hl as default};
