import{s as f}from"./request.9c690564.js";import{a as S}from"./userUtil.2a89dae5.js";import{e as z,f as k,g as N,i as g,o as d,c as _,a as v,j as n,k as l,n as h,t as E,q as y,G as B,F as V,E as m,P as D,x as R,y as U,_ as j}from"./index.e4ce814e.js";import"./cookieUtil.c9429606.js";function A(p){const a=new Date(p),i=(Date.now()-a.getTime())/1e3;return i<30?"\u521A\u521A":i<3600?Math.ceil(i/60)+"\u5206\u949F\u524D":i<3600*24?Math.ceil(i/3600)+"\u5C0F\u65F6\u524D":i<3600*24*2?"1\u5929\u524D":a.getFullYear()+"\u5E74"+a.getMonth()+1+"\u6708"+a.getDate()+"\u65E5"+a.getHours()+"\u65F6"+a.getMinutes()+"\u5206"}const H=p=>(R("data-v-862c7baf"),p=p(),U(),p),O=H(()=>v("div",{class:"title"},"\u7D20\u6750\u62A5\u8BEF",-1)),P={class:"handle"},q={class:"content"},G={key:0},K={key:1,style:{color:"red"}},L={key:2,style:{color:"green"}},Y={key:0,style:{color:"red"}},J={key:1,style:{color:"green"}},Q={class:"page"},W=z({__name:"errorReport",setup(p){const a=k([]),c=k({}),i=()=>{a.value.filter(e=>e.status==1).forEach(e=>w(e))},x=e=>{f.get("/blockTodo/page/"+e).then(o=>{c.value=o.data,a.value=c.value.records,a.value.forEach(s=>{s.time=A(s.time)})})},F=()=>{f.get("/blockTodo/page/1").then(e=>{c.value=e.data,a.value=c.value.records,a.value.forEach(u=>{u.time=A(u.time)})})},w=e=>{delete e.time,f.post("/blockTodo",e).then(o=>{let u=o;u.data?(m.success("\u6210\u529F"),F()):m.warning(u.msg)}).catch(()=>m.error("\u8BF7\u6C42\u51FA\u9519"))},T=e=>{D.prompt("\u9A73\u56DE\u7406\u7531","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88"}).then(({value:o})=>{delete e.time,e.remark=o,f.post("/blockTodo",e).then(u=>{let s=u;s.data?(m.success("\u6210\u529F"),F()):m.warning(s.msg)}).catch(()=>m.error("\u8BF7\u6C42\u51FA\u9519"))})},C=e=>{let o=S();return e.checkor.indexOf(o)!=-1},M=e=>{let o=e.taskTodo.paperId;f.get("/crime/paper/"+o).then(u=>{let s=u.data,r=`<div style="">
                            <div><span style="font-weight:bold">\u57FA\u672C\u4E8B\u5B9E\uFF1A</span>${s.baseInfo}</div>
                            <div><span style="font-weight:bold">\u88C1\u5224\u8FC7\u7A0B\uFF1A</span>${s.analysisProcess}</div>
                            <div><span style="font-weight:bold">\u88C1\u5224\u7ED3\u679C\uFF1A</span>${s.result}</div></div>`;D.alert(r,s.name,{confirmButtonText:"OK",dangerouslyUseHTMLString:!0})})};return N(()=>{F()}),(e,o)=>{const u=g("el-button"),s=g("el-popconfirm"),r=g("el-table-column"),I=g("el-table"),$=g("el-pagination");return d(),_(V,null,[O,v("div",P,[n(s,{title:"\u786E\u8BA4\u8981\u4F7F\u7528\u8BE5\u9879?"},{reference:l(()=>[n(u,{type:"warning",onClick:o[0]||(o[0]=t=>i())},{default:l(()=>[h("\u4E00\u952E\u540C\u610F")]),_:1})]),_:1})]),v("div",q,[n(I,{data:a.value,style:{width:"100%"},stripe:!0},{default:l(()=>[n(r,{type:"index"}),n(r,{prop:"reportor",label:"\u63D0\u4EA4\u4EBA",sortable:"",width:"150"}),n(r,{prop:"checkor",label:"\u68C0\u67E5\u4EBA",sortable:"",width:"150"}),n(r,{prop:"reason",label:"\u62A5\u8BEF\u539F\u56E0",sortable:"",width:"300"}),n(r,{prop:"time",label:"\u66F4\u65B0\u65F6\u95F4",sortable:"",width:"200"}),n(r,{label:"\u72B6\u6001",sortable:"",width:"100"},{default:l(t=>[t.row.status==1?(d(),_("span",G,"\u5904\u7406\u4E2D")):t.row.status==-1?(d(),_("span",K,"\u88AB\u9A73\u56DE")):(d(),_("span",L,"\u5DF2\u5B8C\u6210"))]),_:1}),n(r,{label:"\u53CD\u9988\u7ED3\u679C"},{default:l(t=>[t.row.status==-1?(d(),_("span",Y,E(t.row.remark),1)):(d(),_("span",J,E(t.row.remark),1))]),_:1}),n(r,{align:"right",width:"200",fixed:"right"},{default:l(t=>[n(u,{size:"small",type:"info",onClick:b=>M(t.row)},{default:l(()=>[h("\u8BE6\u60C5")]),_:2},1032,["onClick"]),t.row.status==1&&C(t.row)?(d(),y(u,{key:0,size:"small",type:"success",onClick:b=>w(t.row)},{default:l(()=>[h("\u540C\u610F")]),_:2},1032,["onClick"])):B("",!0),t.row.status==1&&C(t.row)?(d(),y(u,{key:1,size:"small",type:"danger",onClick:b=>T(t.row)},{default:l(()=>[h("\u9A73\u56DE")]),_:2},1032,["onClick"])):B("",!0)]),_:1})]),_:1},8,["data"]),v("div",Q,[n($,{"current-page":c.value.current,"onUpdate:current-page":o[1]||(o[1]=t=>c.value.current=t),"page-size":15,background:!0,layout:"prev, pager, next, jumper",total:c.value.total,onCurrentChange:x},null,8,["current-page","total"])])])],64)}}});const oe=j(W,[["__scopeId","data-v-862c7baf"]]);export{oe as default};
